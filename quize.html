<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>اختبار التكييف القانوني</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
      :root {
        --primary-color: #2563eb;
        --secondary-color: #1e40af;
        --success-color: #22c55e;
        --error-color: #ef4444;
        --background-color: #f8fafc;
        --text-color: #1e293b;
        --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: 'Tajawal', Arial, sans-serif;
        background: var(--background-color);
        color: var(--text-color);
        line-height: 1.6;
      }

      header {
        background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url("ain.jpg") center/cover no-repeat;
        padding: 60px 0;
        text-align: center;
        color: white;
      }

      header h1 {
        margin: 0;
        font-size: 2.8rem;
        font-weight: 700;
        letter-spacing: -0.5px;
      }

      .container {
        max-width: 1000px;
        margin: 40px auto;
        padding: 0 20px;
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
      }

      .card {
        background: white;
        border-radius: 12px;
        box-shadow: var(--card-shadow);
        padding: 20px 10px;
        text-align: center;
        font-size: 1.3rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
      }

      .card:hover {
        transform: translateY(-5px);
        border-color: var(--primary-color);
        background: #f0f9ff;
      }

      #quiz {
        display: none;
        background: white;
        border-radius: 15px;
        box-shadow: var(--card-shadow);
        padding: 30px;
        margin-top: 20px;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      #q-text {
        font-size: 1.5rem;
        margin-bottom: 25px;
        font-weight: 500;
        color: var(--text-color);
        line-height: 1.4;
      }

      .option {
        display: block;
        padding: 15px 20px;
        margin: 12px 0;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        background: white;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 1.1rem;
        line-height: 1.6;
      }

      .option:hover {
        border-color: var(--primary-color);
        background: #f0f9ff;
      }

      .correct {
        background: #f0fdf4 !important;
        border-color: var(--success-color) !important;
        color: #166534;
      }

      .wrong {
        background: #fef2f2 !important;
        border-color: var(--error-color) !important;
        color: #991b1b;
      }

      #punishment {
        margin-top: 25px;
        padding: 15px;
        background: #f8fafc;
        border-radius: 8px;
        font-weight: 500;
        color: var(--text-color);
        border-right: 4px solid var(--primary-color);
      }

      #back {
        margin-top: 25px;
        display: inline-block;
        padding: 12px 25px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        transition: background 0.2s ease;
        font-family: 'Tajawal', Arial, sans-serif;
      }

      #back:hover {
        background: var(--secondary-color);
      }

      #score-container {
        text-align: center;
        margin-bottom: 20px;
        padding: 15px;
        background: white;
        border-radius: 10px;
        box-shadow: var(--card-shadow);
      }

      #score {
        font-size: 1.2rem;
        font-weight: 500;
        color: var(--primary-color);
      }

      @media (max-width: 768px) {
        .container {
          padding: 0 15px;
        }
        
        header h1 {
          font-size: 2rem;
        }
        
        .grid {
          grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
          gap: 10px;
        }
        
        #quiz {
          padding: 20px;
        }
        
        #q-text {
          font-size: 1.3rem;
        }
        
        .nav-buttons {
          flex-direction: column;
          gap: 8px;
        }
        
        #quiz-controls {
          flex-direction: column;
          gap: 15px;
        }
      }

      #landing-page {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url("ain.jpg") center/cover no-repeat fixed;
        text-align: center;
        color: white;
        position: relative;
      }

      .main-title {
        font-size: 4rem;
        font-weight: 900;
        margin: 0;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        animation: fadeInDown 1s ease;
      }

      .sub-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-top: 1rem;
        color: #e2e8f0;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        animation: fadeInUp 1s ease;
      }

      .start-btn {
        margin-top: 2rem;
        padding: 1rem 3rem;
        font-size: 1.2rem;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: 'Tajawal', Arial, sans-serif;
        font-weight: 500;
        animation: fadeIn 1s ease 0.5s both;
      }

      .start-btn:hover {
        background: var(--secondary-color);
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      /* Main Options Styles */
      .main-options {
        display: none;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        padding: 40px;
      }

      .main-option {
        width: 300px;
        padding: 20px;
        background: white;
        border-radius: 15px;
        box-shadow: var(--card-shadow);
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .main-option:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .main-option h3 {
        margin: 0;
        color: var(--primary-color);
        font-size: 1.5rem;
      }

      /* Emoji Quiz Styles */
      .emoji-quiz {
        display: none;
        padding: 40px;
        max-width: 800px;
        margin: 40px auto;
      }

      .emoji-question {
        background: white;
        padding: 20px;
        margin-bottom: 20px;
        border-left: 5px solid var(--primary-color);
        border-radius: 8px;
        box-shadow: var(--card-shadow);
      }

      .emoji-display {
        font-size: 3rem;
        margin-bottom: 20px;
        text-align: center;
      }

      .emoji-options {
        display: flex;
        flex-direction: column;
        gap: 10px;
        background: #f8fafc;
        border-radius: 10px;
        border: 1.5px solid #e2e8f0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        padding: 18px 12px 10px 12px;
        margin-bottom: 10px;
        margin-top: 8px;
        transition: all 0.3s cubic-bezier(.4,2,.6,1);
      }

      .emoji-option {
        padding: 15px;
        border: none;
        border-radius: 8px;
        background: #f8f9fa;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: right;
      }

      .emoji-option:hover {
        background: #e9ecef;
        transform: translateX(-5px);
      }

      .emoji-option.correct {
        background: #d4edda;
        border-color: #28a745;
      }

      .emoji-option.incorrect {
        background: #f8d7da;
        border-color: #dc3545;
      }

      .emoji-result {
        margin-top: 15px;
        padding: 10px;
        border-radius: 8px;
        text-align: center;
        font-weight: bold;
      }

      /* Analytical Scenario Styles */
      .analytical-scenario {
        display: none;
        padding: 40px;
        max-width: 800px;
        margin: 40px auto;
        background: white;
        border-radius: 15px;
        box-shadow: var(--card-shadow);
      }

      .scenario-text {
        font-size: 1.1rem;
        line-height: 1.8;
        margin-bottom: 30px;
        text-align: justify;
      }

      .back-button {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 25px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        transition: all 0.2s ease;
      }

      .back-button:hover {
        background: var(--secondary-color);
      }

      #quiz-section {
        display: none;
      }

      @keyframes fadeInDown {
        from {
          opacity: 0;
          transform: translateY(-30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .nav-buttons {
        display: flex;
        gap: 10px;
        margin-top: 20px;
      }

      .nav-btn {
        padding: 12px 25px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        transition: all 0.2s ease;
        font-family: 'Tajawal', Arial, sans-serif;
      }

      .nav-btn:hover {
        background: var(--secondary-color);
      }

      .nav-btn:disabled {
        background: #cbd5e1;
        cursor: not-allowed;
      }

      #quiz-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 25px;
      }

      .section-header {
        text-align: center;
        margin: 30px 0;
        padding: 15px;
        background: var(--primary-color);
        color: white;
        border-radius: 10px;
        font-size: 1.5rem;
        font-weight: 700;
      }

      .section {
        margin-bottom: 40px;
      }

      .scenario {
        background: #f8fafc;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        border-right: 4px solid var(--primary-color);
        font-weight: 500;
      }

      .question {
        margin-bottom: 15px;
        font-weight: 500;
      }

      .option-label {
        font-weight: 700;
        margin-right: 12px;
        color: var(--primary-color);
        display: inline-block;
        min-width: 25px;
      }

      .back-to-main {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 25px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        transition: background 0.2s ease;
        font-family: 'Tajawal', Arial, sans-serif;
        z-index: 1000;
      }

      .back-to-main:hover {
        background: var(--secondary-color);
      }

      .question-page {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--background-color);
        z-index: 999;
        overflow-y: auto;
      }

      .question-container {
        max-width: 800px;
        margin: 80px auto;
        padding: 30px;
        background: white;
        border-radius: 15px;
        box-shadow: var(--card-shadow);
        position: relative;
      }

      .question-nav {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid #e2e8f0;
      }

      .question-nav button {
        padding: 12px 25px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        transition: all 0.2s ease;
        font-family: 'Tajawal', Arial, sans-serif;
      }

      .question-nav button:hover {
        background: var(--secondary-color);
      }

      .question-nav button:disabled {
        background: #cbd5e1;
        cursor: not-allowed;
      }

      /* Wheel of Fortune Styles */
      .wheel-container {
        display: none;
        flex-direction: column;
        align-items: center;
        padding: 40px;
        background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url("ain.jpg") center/cover no-repeat fixed;
        min-height: 100vh;
      }

      .wheel {
        width: 340px;
        height: 340px;
        border-radius: 50%;
        position: relative;
        box-shadow: 0 8px 32px rgba(0,0,0,0.25);
        border: 10px solid #fff;
        background: conic-gradient(
          #ef4444 0 120deg,      /* Red: Quizzes */
          #2563eb 120deg 240deg, /* Blue: Predict Crime with Emojis */
          #22c55e 240deg 360deg  /* Green: Solve the Crime */
        );
        transition: transform 3s cubic-bezier(0.17, 0.67, 0.83, 0.67);
        transform: rotate(0deg);
        overflow: visible;
      }

      .wheel-label {
        position: absolute;
        width: 90px;
        left: 50%;
        top: 50%;
        transform-origin: 0 0;
        color: #fff;
        font-size: 1.05rem;
        font-weight: bold;
        text-shadow: 1px 1px 6px rgba(0,0,0,0.25);
        text-align: center;
        pointer-events: none;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 80px;
        line-height: 1.3;
        padding: 0 2px;
      }

      .wheel-label.quizzes {
        transform: rotate(-60deg) translate(60px, -25px) rotate(60deg); /* Red section */
      }
      .wheel-label.emojis {
        transform: rotate(180deg) translate(60px, -25px) rotate(-180deg); /* Blue section */
      }
      .wheel-label.solve {
        transform: rotate(240deg) translate(120px, -25px) rotate(-240deg); /* Green section, moved even further left */
      }

      .wheel-pointer {
        width: 0; height: 0;
        border-left: 18px solid transparent;
        border-right: 18px solid transparent;
        border-bottom: 32px solid #fff;
        position: absolute;
        top: -38px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 2;
        filter: drop-shadow(0 2px 6px rgba(0,0,0,0.2));
      }

      .spin-button {
        margin-top: 30px;
        padding: 15px 40px;
        font-size: 1.2rem;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: 'Tajawal', Arial, sans-serif;
        font-weight: 500;
      }

      .spin-button:hover {
        background: var(--secondary-color);
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .spin-button:disabled {
        background: #cbd5e1;
        cursor: not-allowed;
        transform: none;
      }

      .loading {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 20px 40px;
        border-radius: 10px;
        font-size: 1.2rem;
        display: none;
        z-index: 1000;
      }

      .ent-show-btn {
        display: inline-block;
        padding: 10px 28px;
        background: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        font-size: 1rem;
        font-family: 'Tajawal', Arial, sans-serif;
        font-weight: 500;
        margin-bottom: 8px;
        margin-top: 0;
        box-shadow: 0 2px 8px rgba(37,99,235,0.08);
        transition: background 0.2s, box-shadow 0.2s, transform 0.2s;
      }
      .ent-show-btn:hover {
        background: var(--secondary-color);
        box-shadow: 0 4px 16px rgba(30,64,175,0.12);
        transform: translateY(-2px) scale(1.03);
      }

      .ent-options {
        display: flex;
        flex-direction: column;
        gap: 10px;
        background: #f8fafc;
        border-radius: 10px;
        border: 1.5px solid #e2e8f0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        padding: 18px 12px 10px 12px;
        margin-bottom: 10px;
        margin-top: 8px;
        transition: all 0.3s cubic-bezier(.4,2,.6,1);
      }

      .ent-option {
        display: block;
        width: 100%;
        padding: 15px 20px;
        margin: 0;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        background: white;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 1.1rem;
        font-family: 'Tajawal', Arial, sans-serif;
        font-weight: 500;
        text-align: right;
        box-shadow: 0 1px 4px rgba(0,0,0,0.03);
      }
      .ent-option:hover:enabled {
        border-color: var(--primary-color);
        background: #f0f9ff;
        color: var(--primary-color);
        transform: translateX(-3px);
      }
      .ent-option:disabled {
        opacity: 0.7;
        cursor: not-allowed;
      }
      .ent-option.correct {
        background: #f0fdf4 !important;
        border-color: var(--success-color) !important;
        color: #166534;
      }
      .ent-option.wrong {
        background: #fef2f2 !important;
        border-color: var(--error-color) !important;
        color: #991b1b;
      }
    </style>
  </head>
  <body>
    <div id="landing-page">
      <h1 class="main-title">جمعية عين</h1>
      <h2 class="sub-title">بوث القانون</h2>
      <button class="start-btn" onclick="showMainOptions()">ابدأ الاختبار</button>
    </div>

    <div class="main-options">
      <div class="main-option" onclick="showShortQuestions()">
        <h3>أسئلة قصيرة</h3>
      </div>
      <div class="main-option" onclick="showEmojiQuiz()">
        <h3>توقع الجريمة من خلال الايموجي</h3>
      </div>
      <div class="main-option" onclick="showAnalyticalScenario()">
        <h3>تحليل الجريمة</h3>
      </div>
    </div>

    <div id="quiz-section" style="display: none;">
      <header>
        <button class="back-to-main" onclick="returnToMainOptions()" style="position: absolute; top: 20px; right: 20px;">العودة للخيارات</button>
        <h1>اختبار التكييف القانوني</h1>
      </header>
      <div class="container">
        <div id="score-container">
          <div id="score">النتيجة: <span id="correct-answers">0</span> من <span id="total-questions">0</span></div>
        </div>
        <div class="section">
          <div class="section-header">القسم الجنائي</div>
          <div id="cards-criminal" class="grid"></div>
        </div>

        <div class="section">
          <div class="section-header">القسم المدني</div>
          <div id="cards-civil" class="grid"></div>
        </div>

        <div class="section">
          <div class="section-header">القسم الإلكتروني</div>
          <div id="cards-electronic" class="grid"></div>
        </div>
      </div>
    </div>

    <div id="question-page" class="question-page">
      <button class="back-to-main" onclick="returnToMain()">العودة للصفحة الرئيسية</button>
      <div class="question-container">
        <div id="q-text"></div>
        <div id="options"></div>
        <div id="punishment"></div>
        <div class="question-nav">
          <button id="prev-question" onclick="navigateQuestion(-1)">السؤال السابق</button>
          <button id="next-question" onclick="navigateQuestion(1)">السؤال التالي</button>
        </div>
      </div>
    </div>

    <div class="emoji-quiz">
      <button class="back-button" onclick="returnToMainOptions()">العودة للخيارات</button>
      <h2>توقع الجريمة من خلال الايموجي</h2>
      <div id="emoji-questions"></div>
    </div>

    <div class="analytical-scenario">
      <button class="back-button" onclick="returnToMainOptions()">العودة للخيارات</button>
      <h2>تحليل الجريمة</h2>
      <div class="scenario-text">
        في أحد الأحياء القديمة كان هناك رجل يدعى رامي يملك ورشة لتصليح الساعات وكان لديه موظف اسمه أدهم وفي يوم من الأيام حضر شخص يدعى فراس وطلب من أدهم أن يصلح له ساعة وأخبره بأنه مستعجل عليها كثيرًا وأنها ثمينة أخذ أدهم الساعة وعند فتحها اكتشف وجود كيس صغير بداخله مسحوق أبيض اشتبه بأنه مخدرات لكنه لم يخبر رامي صاحب الورشة وبعد الانتهاء من التصليح قرر الاحتفاظ بالكيس لنفسه دون إعلام فراس فأخذ الكيس وأخفاه في منزله بعد يومين عاد فراس إلى الورشة ووجد رامي هناك وطلب منه الساعة فأبلغه رامي بأنها غير موجودة وأن عليه العودة في اليوم التالي غضب فراس وبدأ يسب وسمع أدهم ذلك فواجهه وقال له إن الساعة قد سُرقت لكن فراس شك بوجود أمر مريب فقام بإبلاغ الشرطة فتولت الشرطة فتح تحقيق ومع البحث عُثر على الكيس المخفي في منزل أدهم وفُحص فتبين أنه يحتوي على هيروين وكانت بصمات أدهم وفراس عليهما معًا بعد اكتشاف الكيس المخفي واحتوائه على الهيروين وضبط بصمات أدهم وفراس عليه بدأت الشرطة بالتحقيق مع الطرفين أدهم أنكر علمه بمحتوى الكيس وقال إنه وجد الكيس داخل الساعة ولم يخبر رامي لأنه خاف من المشاكل أما فراس فأكد أن الساعة لم تُسرق وأنه لم يكن يعلم بوجود مخدرات بداخلها وأن بصماته على الكيس تعود لمرة سابقة عندما كان يعبث بالساعة في التحقيقات تبين أيضًا أن رامي لم يكن على علم بوجود المخدرات داخل الورشة ولم يشارك في أي فعل متعلق بها
      </div>
      <div class="question">ما مسؤولية كل من أدهم وفراس ورامي مع التكييف القانوني؟</div>
      <div class="options">
        <div class="option" onclick="checkAnalyticalAnswer(0)">أ. أدهم مسؤول عن حيازة مخدرات بقصد الاتجار وفراس شريك في الحيازة ورامي غير مسؤول</div>
        <div class="option" onclick="checkAnalyticalAnswer(1)">ب. أدهم مسؤول عن الحيازة فقط وفراس غير مسؤول ورامي مسؤول عن الإهمال في مراقبة موظفه</div>
        <div class="option" onclick="checkAnalyticalAnswer(2)">ج. أدهم مسؤول عن حيازة مخدرات مع نية الإخفاء وفراس متهم بمساعدة غير مقصودة ورامي غير مسؤول</div>
        <div class="option" onclick="checkAnalyticalAnswer(3)">د. أدهم وفراس متهمان بالاشتراك في جريمة حيازة المخدرات ورامي مسؤول عن جريمة التستر</div>
      </div>
    </div>

    <div class="wheel-container">
      <h1 style="color: white; margin-bottom: 30px;">Wheel of Fortune</h1>
      <div style="position: relative; width: 340px; height: 370px;">
        <div class="wheel-pointer"></div>
        <div class="wheel">
          <div class="wheel-label quizzes">Quizzes</div>
          <div class="wheel-label emojis">Predict Crime<br>with Emojis</div>
          <div class="wheel-label solve">Solve the Crime</div>
        </div>
      </div>
      <button class="spin-button" onclick="spinWheel()">Spin the Wheel</button>
    </div>
    <div class="loading">Loading...</div>

    <script>
      function startQuiz() {
        document.getElementById('landing-page').style.display = 'none';
        document.getElementById('quiz-section').style.display = 'block';
      }

      const data = {
        criminal: [
          {
            text: "(1) طعن في مشاجرة جامعية",
            scenario: "السيناريو: خلال شجار بين طالبين في ساحة الجامعة، أحدهم استلّ سكينًا من حقيبته وطعن الآخر في كتفه، مسببًا له إصابة استدعت تدخلًا طبيًا عاجلًا. الطالب يقول إنه لم يقصد القتل، فقط أراد \"يخوفه\".",
            question: "ما التكييف القانوني لهذه الجريمة؟",
            opts: [
              { label: "أ", text: "مشاجرة بسيطة وعقوبتها تأديبية فقط" },
              { label: "ب", text: "شروع في القتل عمدًا" },
              { label: "ج", text: "اعتداء غير مقصود لأنه ما كانت نيته القتل" }
            ],
            ans: 1,
            pun: "استعمال أداة خطرة (كالسكين) في موضع حساس من الجسد خلال شجار يُعد شروعًا في القتل إذا وُجدت نية الاعتداء، حتى لو لم تكن هناك نية صريحة للقتل. ويُعاقب عليه القانون الفلسطيني بعقوبة تصل إلى السجن 10 سنوات أو أكثر حسب جسامة الإصابة"
          },
          {
            text: "(2) اقتحم بيت وسكن فيه!",
            scenario: "السيناريو: شخص دخل منزل مهجور وسكن فيه بدون إذن صاحبه.",
            question: "شو التكييف القانوني؟",
            opts: [
              { label: "أ", text: "انتهاك حرمة ملك الغير" },
              { label: "ب", text: "تسلّل غير مشروع" },
              { label: "ج", text: "غصب عقار" }
            ],
            ans: 2,
            pun: "الحبس حتى سنتين أو الغرامة أو كلتيهما (المادة 279 عقوبات)"
          },
          {
            text: "(3) سرق جوال من محل!",
            scenario: "السيناريو: شخص دخل محل تجاري وسرق جوال من فوق الطاولة.",
            question: "شو التكييف القانوني؟",
            opts: [
              { label: "أ", text: "سرقة بسيطة" },
              { label: "ب", text: "سرقة موصوفة" },
              { label: "ج", text: "خيانة أمانة" }
            ],
            ans: 0,
            pun: "الحبس من 3 أشهر إلى 3 سنوات (المادة 404 عقوبات)"
          },
          {
            text: "(4) امرأة خطفت طفلًا!",
            scenario: "السيناريو: امرأة أخذت طفلًا من يد أمه وهربت به.",
            question: "شو التكييف القانوني؟",
            opts: [
              { label: "أ", text: "خطف قاصر" },
              { label: "ب", text: "اختطاف بهدف التبني" },
              { label: "ج", text: "حرمان من الحضانة" }
            ],
            ans: 0,
            pun: "الحبس من 5 إلى 15 سنة (المادة 290 عقوبات)"
          },
          {
            text: "(5) ضرب مسنّ بساطور!",
            scenario: "السيناريو: شاب ضرب رجلًا مسنًّا بساطور وأحدث له كسرًا في يده.",
            question: "شو التكييف القانوني؟",
            opts: [
              { label: "أ", text: "إيذاء بسيط" },
              { label: "ب", text: "إيذاء بآلة مؤذية" },
              { label: "ج", text: "شروع بالقتل" }
            ],
            ans: 1,
            pun: "الحبس من 6 أشهر إلى 3 سنوات (المادة 333 عقوبات)"
          },
          {
            text: "(6) إحراق سيارة الجار!",
            scenario: "السيناريو: شخص أشعل النار عمدًا في سيارة جاره بسبب خلاف قديم.",
            question: "شو التكييف القانوني؟",
            opts: [
              { label: "أ", text: "تخريب ممتلكات" },
              { label: "ب", text: "حريق عمد" },
              { label: "ج", text: "تهديد وابتزاز" }
            ],
            ans: 1,
            pun: "الأشغال الشاقة المؤقتة (المادة 368 عقوبات)"
          },
          {
            text: "(7) دهس شخص على ممر المشاة!",
            scenario: "السيناريو: سائق كان يقود سيارته في طريق الجامعة، فدهس أحد المارّة أثناء عبوره من ممر المشاة، ثم غادر المكان بسرعة دون أن يتوقف أو يقدّم أي مساعدة للمصاب أو يُبلّغ الشرطة.",
            question: "ما التكييف القانوني لهذا التصرف؟",
            opts: [
              { label: "أ", text: "قتل غير عمد" },
              { label: "ب", text: "جريمة ترك موقع الحادث" },
              { label: "ج", text: "إصابة نتيجة الإهمال" }
            ],
            ans: 1,
            pun: "الفرار من مكان الحادث بعد التسبب بإصابة شخص يُعد جريمة مستقلة وفق قانون المرور الفلسطيني. حتى لو كان الحادث غير مقصود، يُلزم القانون السائق بالتوقف، الإبلاغ، وتقديم المساعدة، وإلا عُدّ فعله جريمة فرار، وتُعاقب بالسجن أو الغرامة أو كليهما"
          },
          {
            text: "(8) سرقة من داخل سيارة!",
            scenario: "السيناريو: لص فتح سيارة وسرق حقيبة من داخلها.",
            question: "شو التكييف القانوني؟",
            opts: [
              { label: "أ", text: "سرقة موصوفة" },
              { label: "ب", text: "خيانة أمانة" },
              { label: "ج", text: "إتلاف ممتلكات" }
            ],
            ans: 0,
            pun: "الأشغال الشاقة المؤقتة (المادة 401 عقوبات)"
          },
          {
            text: "(9) موظف اختلس مال عام!",
            scenario: "السيناريو: موظف حكومي أخذ جزءًا من الأموال التي يديرها لحسابه.",
            question: "شو التكييف القانوني؟",
            opts: [
              { label: "أ", text: "إساءة استعمال السلطة" },
              { label: "ب", text: "اختلاس" },
              { label: "ج", text: "خيانة أمانة" }
            ],
            ans: 1,
            pun: "الأشغال الشاقة المؤقتة (المادة 174 عقوبات)"
          },
          {
            text: "(10) نشر إشاعة عن فتاة!",
            scenario: "السيناريو: شاب نشر بوست فيه إشاعة سيئة عن سمعة فتاة.",
            question: "شو التكييف القانوني؟",
            opts: [
              { label: "أ", text: "قذف" },
              { label: "ب", text: "تشهير" },
              { label: "ج", text: "تحقير" }
            ],
            ans: 1,
            pun: "الحبس حتى سنة أو الغرامة (المادة 358 عقوبات)"
          }
        ],
        civil: [
          {
            text: "(1) عقد بدون توقيع",
            scenario: "السيناريو: أمجد اتفق شفهيًا مع صاحب شقة إنه يستأجرها لمدة سنة بمبلغ 2000 شيكل شهريًا. بعد 5 شهور، طلب منه صاحب الشقة يخرج لأنه ما في عقد مكتوب.",
            question: "هل يحق لصاحب الشقة طرده فورًا؟",
            opts: [
              { label: "أ", text: "نعم، لأنه لا يوجد عقد مكتوب" },
              { label: "ب", text: "لا، لأن الاتفاق الشفهي ملزم إذا ثبت" },
              { label: "ج", text: "نعم، لأن العقد الشفهي لا يُعتد به في الإيجارات" }
            ],
            ans: 1,
            pun: "القانون المدني الفلسطيني يعترف بالعقد الشفهي إذا توافرت أركانه (الإيجاب، القبول، المحل، السبب)، ويمكن إثباته بأي وسيلة، خصوصًا إذا دفع الإيجار شهريًا"
          },
          {
            text: "(2) وصل أمانة لصديق",
            scenario: "السيناريو: أماني أعطت صديقتها روان مبلغ 5000 شيكل وسجّلت عليها \"وصل أمانة\" بخط يدها. بعد فترة أنكرت روان الدين.",
            question: "هل يُعد الوصل دليلاً كافيًا لإثبات الدين؟",
            opts: [
              { label: "أ", text: "لا، لأن الوصل بين أصدقاء" },
              { label: "ب", text: "نعم، لأن الوصل يعتبر سندًا ملزمًا" },
              { label: "ج", text: "فقط إذا وُجد شاهد" }
            ],
            ans: 1,
            pun: "وصل الأمانة يُعد سندًا كتابيًا يُمكن الاستناد إليه في إثبات الالتزام المالي"
          },
          {
            text: "(3) سقوط الدين بالتقادم",
            scenario: "السيناريو: أحمد كان له دين على زميله من 7 سنوات، وما طالب فيه طوال هذه المدة. لما طالب فيه، أنكر زميله الدين.",
            question: "هل يسقط حق أحمد بالمطالبة؟",
            opts: [
              { label: "أ", text: "لا يسقط أبدًا" },
              { label: "ب", text: "نعم، لأن الدين سقط بالتقادم" },
              { label: "ج", text: "يسقط فقط إذا مات المدين" }
            ],
            ans: 1,
            pun: "الدين المدني يسقط بالتقادم بعد مرور 5 سنوات دون مطالبة، إلا في حالات خاصة ينص فيها القانون على مدة مختلفة"
          },
          {
            text: "(4) حادث في متجر",
            scenario: "السيناريو: ليان وقعت في سوبرماركت بسبب مياه على الأرض بدون لافتة تحذيرية، وأصيبت بكسر.",
            question: "هل يحق لها المطالبة بتعويض؟",
            opts: [
              { label: "أ", text: "لا، لأنها لم تنتبه" },
              { label: "ب", text: "نعم، المتجر مسؤول عن سلامة الزبائن" },
              { label: "ج", text: "فقط إذا شاهد أحد الحادث" }
            ],
            ans: 1,
            pun: "المتجر ملزم قانونًا بضمان سلامة الزبائن، والتقصير في ذلك يرتب مسؤولية تقصيرية وتعويض"
          },
          {
            text: "(5) فصل موظف دون إنذار",
            scenario: "السيناريو: رامي اشتغل 8 شهور بمطعم بدون عقد مكتوب، وفُصل فجأة بدون سبب.",
            question: "هل يمكنه المطالبة بتعويض؟",
            opts: [
              { label: "أ", text: "لا، لأنه لا يوجد عقد" },
              { label: "ب", text: "نعم، لأن العمل الفعلي يثبت العلاقة التعاقدية" },
              { label: "ج", text: "فقط إذا اشتغل سنة كاملة" }
            ],
            ans: 1,
            pun: "القانون يعترف بالعلاقة التعاقدية حتى بدون عقد مكتوب إذا توفرت الأدلة (مثل دوام، شهود، تحويل راتب)"
          },
          {
            text: "(6) تسريب مياه من بناء جديد",
            scenario: "السيناريو: رجل بنى طابق جديد بدون ترخيص، وبدأت المياه تتسرب لجدران الجيران.",
            question: "هل يحق للجيران مقاضاته؟",
            opts: [
              { label: "أ", text: "لا، لأنه يبني في أرضه" },
              { label: "ب", text: "نعم، لأنه ألحق ضررًا بالغير" },
              { label: "ج", text: "فقط إذا البناء مخالف لشروط البلدية" }
            ],
            ans: 1,
            pun: "لا يجوز استعمال الحق بما يسبب ضررًا للغير، وهذا مبدأ منصوص عليه في القانون المدني"
          },
          {
            text: "(7) منتج معيب ورفض الإرجاع",
            scenario: "السيناريو: دانيا اشترت خلاط كهربائي وتوقف عن العمل بعد يومين، والمحل رفض تبديله.",
            question: "هل يحق لها المطالبة بالتبديل أو التعويض؟",
            opts: [
              { label: "أ", text: "نعم، إذا كان هناك ضمان" },
              { label: "ب", text: "لا، لأن البضاعة لا تُرد" },
              { label: "ج", text: "فقط إذا المشتري فحصه قبل الشراء" }
            ],
            ans: 0,
            pun: "وجود عيب خفي أو خلل في المنتج يوجب على البائع تعويض المشتري أو إصلاح العيب أو استبدال المنتج حسب القانون"
          },
          {
            text: "(8) رفض إرجاع العربون",
            scenario: "السيناريو: معتز دفع 1000 شيكل عربون لحجز قاعة أفراح، لكن بعدها قرر يلغي الحجز قبل الموعد بشهرين. صاحب القاعة رفض يرجّع العربون.",
            question: "هل يحق لصاحب القاعة الاحتفاظ بالعربون؟",
            opts: [
              { label: "أ", text: "نعم، العربون يضيع إذا ألغي العقد من الطرف الدافع" },
              { label: "ب", text: "لا، يجب إرجاعه كاملًا مهما كانت الظروف" },
              { label: "ج", text: "فقط إذا مضى أكثر من شهر على الحجز" }
            ],
            ans: 0,
            pun: "العربون يُعد جزءًا من العقد، وإذا تراجع من دفعه عن الالتزام، يحق للطرف الآخر الاحتفاظ به كتعويض (ما لم يتفقوا على غير ذلك)"
          },
          {
            text: "(9) بيع سيارة بدون نقل ملكية",
            scenario: "السيناريو: وسيم باع سيارته لصديقه أيمن واتفقوا شفهيًا على السعر، وأعطاه المفتاح. بعد شهر، ارتكبت السيارة مخالفة وسُجلت باسم وسيم.",
            question: "من يتحمل المسؤولية القانونية؟",
            opts: [
              { label: "أ", text: "أيمن، لأنه المشتري الفعلي" },
              { label: "ب", text: "وسيم، لأنه لا يزال المالك في الأوراق" },
              { label: "ج", text: "لا أحد لأن السيارة لم تُسجّل بعد" }
            ],
            ans: 1,
            pun: "في القانون المدني، تبقى الملكية القانونية للسيارة باسم صاحبها المسجل، وبالتالي يتحمل المسؤولية إلى حين نقل الملكية رسميًا"
          },
          {
            text: "(10) تخريب في الشقة المستأجرة",
            scenario: "السيناريو: سمية استأجرت شقة لمدة سنة، وعند انتهاء العقد، تركت الجدران مخدوشة والحنفيات مكسورة.",
            question: "هل يحق للمالك خصم مبلغ من التأمين أو المطالبة بتعويض؟",
            opts: [
              { label: "أ", text: "لا، المستأجر غير ملزم بإصلاح الأضرار" },
              { label: "ب", text: "نعم، يجب تسليم العين المؤجرة كما استلمها" },
              { label: "ج", text: "فقط إذا زادت الأضرار عن 1000 شيكل" }
            ],
            ans: 1,
            pun: "المستأجر ملزم بردّ العين المؤجرة بحالتها الأصلية (مع استثناء التلف الطبيعي). وإذا أحدث أضرارًا، يتحمل المسؤولية عنها مدنيًا"
          }
        ],
        electronic: [
          {
            text: "(1) نشر محادثة خاصة",
            scenario: "السيناريو: طالب نشر في صفحة الجامعة صورة لمحادثة واتساب بينه وبين زميلته بدون إذنها، بهدف إحراجها.",
            question: "هل يُعد هذا الفعل جريمة إلكترونية؟",
            opts: [
              { label: "أ", text: "لا، لأنه لم يُعدّل على الكلام" },
              { label: "ب", text: "نعم، لأنه تعدٍ على الخصوصية" },
              { label: "ج", text: "فقط إذا كانت المحادثة مزوّرة" }
            ],
            ans: 1,
            pun: "نشر محادثة خاصة بدون إذن يُعد انتهاكًا للخصوصية ويُعاقب عليه في قانون الجرائم الإلكترونية الفلسطيني"
          },
          {
            text: "(2) إنشاء حساب وهمي باسم دكتور",
            scenario: "السيناريو: أحد الطلاب أنشأ حسابًا وهميًا باسم دكتور جامعي وسخر منه بنشر منشورات ساخرة.",
            question: "ما التكييف القانوني لهذا الفعل؟",
            opts: [
              { label: "أ", text: "انتحال شخصية وسخرية لا يعاقب عليها" },
              { label: "ب", text: "جريمة إلكترونية فيها انتحال وتشهير" },
              { label: "ج", text: "ليست جريمة لأنها لم تُستخدم لكسب مال" }
            ],
            ans: 1,
            pun: "انتحال شخصية عبر الإنترنت ونشر محتوى يسيء يُعد جريمة ويعاقب عليها القانون الفلسطيني"
          },
          {
            text: "(3) تصوير طالبة في القاعة دون علمها",
            scenario: "السيناريو: طالب صوّر زميلته في المحاضرة وسخر منها على الستوري بدون علمها.",
            question: "هل هذا الفعل يُعد جريمة إلكترونية؟",
            opts: [
              { label: "أ", text: "لا، لأنه في مكان عام" },
              { label: "ب", text: "نعم، لأنه مساس بخصوصية الغير" },
              { label: "ج", text: "فقط إذا رُفعت عليه دعوى" }
            ],
            ans: 1,
            pun: "تصوير شخص دون علمه ونشره، حتى في الأماكن العامة، يُعد انتهاكًا للخصوصية"
          },
          {
            text: "(4) اختراق البريد الجامعي",
            scenario: "السيناريو: طالب اخترق البريد الإلكتروني لزميله وسحب منه ملفات أبحاث.",
            question: "ما العقوبة المحتملة لهذا الفعل؟",
            opts: [
              { label: "أ", text: "لا توجد عقوبة طالما لم ينشرها" },
              { label: "ب", text: "يُعد اختراقًا يعاقب عليه بالسجن أو الغرامة" },
              { label: "ج", text: "فقط إذا اشتكى الطالب المتضرر" }
            ],
            ans: 1,
            pun: "اختراق البريد الإلكتروني جريمة معلوماتية واضحة بصرف النظر عن النية أو النشر"
          },
          {
            text: "(5) تهديد طالبة بنشر صورها",
            scenario: "السيناريو: شخص هدد طالبة بنشر صور كانت قد أرسلتها له سابقًا إن لم ترجع لعلاقة سابقة.",
            question: "ما وصف الجريمة؟",
            opts: [
              { label: "أ", text: "خلاف شخصي" },
              { label: "ب", text: "تهديد إلكتروني وابتزاز" },
              { label: "ج", text: "لا تُعد جريمة لأنه لم ينفذ التهديد" }
            ],
            ans: 1,
            pun: "مجرد التهديد بنشر مواد خاصة يعد جريمة ابتزاز إلكتروني حتى لو لم تُنشر"
          },
          {
            text: "(6) سرقة مشروع تخرج",
            scenario: "السيناريو: طالب سرّب مشروع تخرج زميله من فلاش USB ونشره على جروب فيسبوك.",
            question: "هل يحق لصاحب المشروع مقاضاته؟",
            opts: [
              { label: "أ", text: "لا، لأن المشاريع ليست محمية" },
              { label: "ب", text: "نعم، لأنه انتهاك للملكية الفكرية" },
              { label: "ج", text: "فقط إذا فيه براءة اختراع" }
            ],
            ans: 1,
            pun: "مشاريع التخرج محمية بحقوق النشر، وسرقتها أو نشرها يُعد اعتداء على الملكية الفكرية"
          },
          {
            text: "(7) فبركة صورة لطالب",
            scenario: "السيناريو: مجموعة طلاب نشرت صورة مركبة لطالب، تظهره بوضع مسيء على جروب دفعتهم للضحك.",
            question: "ما التكييف القانوني؟",
            opts: [
              { label: "أ", text: "مزحة بين طلاب" },
              { label: "ب", text: "تشهير وإساءة باستخدام وسائل إلكترونية" },
              { label: "ج", text: "مجرد فوتوشوب" }
            ],
            ans: 1,
            pun: "فبركة الصور بقصد الإضرار أو التشويه يُعد جريمة معلوماتية يعاقب عليها القانون"
          },
          {
            text: "(8) إرسال روابط خبيثة",
            scenario: "السيناريو: طالب نشر على مجموعة الدفعة رابطًا يدّعي أنه \"نتائج الامتحانات\" لكنه كان برنامج تجسس.",
            question: "ما نوع الجريمة هنا؟",
            opts: [
              { label: "أ", text: "خداع بسيط" },
              { label: "ب", text: "جريمة إلكترونية تتعلق بإرسال برمجيات ضارة" },
              { label: "ج", text: "لا تُعد جريمة لأنه لم يجمع بيانات" }
            ],
            ans: 1,
            pun: "نشر روابط تحتوي برمجيات تجسس يُعد جريمة إلكترونية سواء تم الاختراق فعلاً أم لا"
          },
          {
            text: "(9) تسجيل صوت محاضرة ونشره بسخرية",
            scenario: "السيناريو: أحد الطلاب سجل صوت الدكتور وهو يعنف طالب، ونشره مع تعليقات ساخرة على تيك توك.",
            question: "هل يُعد ذلك جريمة؟",
            opts: [
              { label: "أ", text: "لا، لأنها محاضرة عامة" },
              { label: "ب", text: "نعم، لأنه تسجيل غير مصرح به وفيه إساءة" },
              { label: "ج", text: "فقط إذا طلب الدكتور حذفها" }
            ],
            ans: 1,
            pun: "تسجيل أشخاص بدون إذن ونشره بطريقة تسيء إليهم يدخل في نطاق الجرائم المعلوماتية"
          },
          {
            text: "(10) اختراق شبكة الإنترنت الجامعية",
            scenario: "السيناريو: طالب قام بفك كلمة مرور شبكة الجامعة ووزعها على أصدقائه.",
            question: "هل يُعد ذلك مخالفة؟",
            opts: [
              { label: "أ", text: "لا، لأن الإنترنت خدمة عامة" },
              { label: "ب", text: "نعم، يُعد اختراقًا لنظام معلوماتي" },
              { label: "ج", text: "فقط إذا تم استخدام الإنترنت لأغراض غير تعليمية" }
            ],
            ans: 1,
            pun: "الوصول غير المشروع إلى نظام معلوماتي (مثل شبكة الجامعة) يُعد جريمة إلكترونية حتى لو لم يحدث ضرر مباشر"
          }
        ]
      };

      // Initialize game state
      let score = 0;
      let answeredQuestions = new Set();
      let incorrectAnswers = new Set();
      let currentQuestionIndex = 0;
      let currentSection = 'criminal';

      // Get DOM elements
      const cardsCriminalEl = document.getElementById("cards-criminal");
      const cardsCivilEl = document.getElementById("cards-civil");
      const cardsElectronicEl = document.getElementById("cards-electronic");
      const quizEl = document.getElementById("quiz");
      const qText = document.getElementById("q-text");
      const optsEl = document.getElementById("options");
      const punEl = document.getElementById("punishment");
      const backBtn = document.getElementById("back");
      const prevBtn = document.getElementById("prev");
      const nextBtn = document.getElementById("next");
      const correctAnswersEl = document.getElementById("correct-answers");
      const totalQuestionsEl = document.getElementById("total-questions");

      // Initialize total questions count
      const totalQuestions = data.criminal.length + data.civil.length + data.electronic.length;
      totalQuestionsEl.textContent = totalQuestions;
      correctAnswersEl.textContent = score;

      // Add this function before updateCards and showQuiz
      function shuffleQuizOptions() {
        ['criminal', 'civil', 'electronic'].forEach(section => {
          data[section].forEach(q => {
            const optionObjs = q.opts.map((opt, i) => ({ ...opt, origIndex: i }));
            for (let i = optionObjs.length - 1; i > 0; i--) {
              const j = Math.floor(Math.random() * (i + 1));
              [optionObjs[i], optionObjs[j]] = [optionObjs[j], optionObjs[i]];
            }
            q.opts = optionObjs.map(o => ({ label: o.label, text: o.text }));
            q.ans = optionObjs.findIndex(o => o.origIndex === q.ans);
          });
        });
      }

      // Call shuffleQuizOptions before updateCards() in initial setup and in showShortQuestions
      shuffleQuizOptions();

      function updateCards() {
        // Criminal section
        cardsCriminalEl.innerHTML = '';
        data.criminal.forEach((_, i) => {
          const d = document.createElement("div");
          d.className = "card";
          d.textContent = i + 1;
          
          if (incorrectAnswers.has(`criminal-${i}`)) {
            d.style.backgroundColor = "#fef2f2";
            d.style.borderColor = "var(--error-color)";
          } else if (answeredQuestions.has(`criminal-${i}`)) {
            d.style.backgroundColor = "#f0fdf4";
            d.style.borderColor = "var(--success-color)";
          }
          
          d.onclick = () => showQuiz('criminal', i);
          cardsCriminalEl.appendChild(d);
        });

        // Civil section
        cardsCivilEl.innerHTML = '';
        data.civil.forEach((_, i) => {
          const d = document.createElement("div");
          d.className = "card";
          d.textContent = i + 1;
          
          if (incorrectAnswers.has(`civil-${i}`)) {
            d.style.backgroundColor = "#fef2f2";
            d.style.borderColor = "var(--error-color)";
          } else if (answeredQuestions.has(`civil-${i}`)) {
            d.style.backgroundColor = "#f0fdf4";
            d.style.borderColor = "var(--success-color)";
          }
          
          d.onclick = () => showQuiz('civil', i);
          cardsCivilEl.appendChild(d);
        });

        // Electronic section
        cardsElectronicEl.innerHTML = '';
        data.electronic.forEach((_, i) => {
          const d = document.createElement("div");
          d.className = "card";
          d.textContent = i + 1;
          
          if (incorrectAnswers.has(`electronic-${i}`)) {
            d.style.backgroundColor = "#fef2f2";
            d.style.borderColor = "var(--error-color)";
          } else if (answeredQuestions.has(`electronic-${i}`)) {
            d.style.backgroundColor = "#f0fdf4";
            d.style.borderColor = "var(--success-color)";
          }
          
          d.onclick = () => showQuiz('electronic', i);
          cardsElectronicEl.appendChild(d);
        });
      }

      // Initial cards creation
      updateCards();

      function showQuiz(section, i) {
        currentSection = section;
        currentQuestionIndex = i;
        
        const question = data[section][i];
        qText.innerHTML = `
          <div class="scenario">${question.scenario}</div>
          <div class="question">${question.question}</div>
        `;
        
        optsEl.innerHTML = "";
        punEl.textContent = "";
        
        // Update navigation buttons state
        updateQuestionNavigation();
        
        question.opts.forEach((opt, j) => {
          const b = document.createElement("div");
          b.className = "option";
          b.textContent = opt.text;
          
          // Add hover effect for options
          b.onmouseover = () => {
            if (!answeredQuestions.has(`${section}-${i}`)) {
              b.style.transform = "translateX(-5px)";
            }
          };
          b.onmouseout = () => {
            b.style.transform = "none";
          };
          
          b.onclick = () => {
            if (!answeredQuestions.has(`${section}-${i}`)) {
              check(section, i, j, b);
            }
          };
          optsEl.appendChild(b);
        });

        // If question was already answered, show previous result
        if (answeredQuestions.has(`${section}-${i}`)) {
          const options = [...optsEl.children];
          options.forEach((opt, j) => {
            if (j === question.ans) {
              opt.classList.add("correct");
            } else if (incorrectAnswers.has(`${section}-${i}`)) {
              opt.classList.add("wrong");
            }
          });
          punEl.textContent = "العقوبة: " + question.pun;
        }

        // Show question page
        document.getElementById('quiz-section').style.display = 'none';
        document.getElementById('question-page').style.display = 'block';
      }

      function updateQuestionNavigation() {
        const prevBtn = document.getElementById('prev-question');
        const nextBtn = document.getElementById('next-question');
        const currentSectionData = data[currentSection];
        
        prevBtn.disabled = currentQuestionIndex === 0;
        nextBtn.disabled = currentQuestionIndex === currentSectionData.length - 1;
      }

      function navigateQuestion(direction) {
        const currentSectionData = data[currentSection];
        const newIndex = currentQuestionIndex + direction;
        
        if (newIndex >= 0 && newIndex < currentSectionData.length) {
          showQuiz(currentSection, newIndex);
        }
      }

      function returnToMain() {
        document.getElementById('question-page').style.display = 'none';
        document.getElementById('quiz-section').style.display = 'block';
      }

      function check(section, i, j, el) {
        const questionId = `${section}-${i}`;
        answeredQuestions.add(questionId);
        
        [...optsEl.children].forEach((x) => (x.onclick = null));
        
        if (j === data[section][i].ans) {
          el.classList.add("correct");
          score++;
          correctAnswersEl.textContent = score;
          
          // Add success animation
          el.style.animation = "correctAnswer 0.5s ease";
        } else {
          el.classList.add("wrong");
          incorrectAnswers.add(questionId);
          optsEl.children[data[section][i].ans].classList.add("correct");
        }

        // Show punishment with fade-in effect
        punEl.style.opacity = "0";
        punEl.textContent = "العقوبة: " + data[section][i].pun;
        setTimeout(() => {
          punEl.style.transition = "opacity 0.5s ease";
          punEl.style.opacity = "1";
        }, 100);

        // Update the cards in the background
        updateCards();
      }

      // Update keypress support for navigation
      document.addEventListener("keydown", (e) => {
        if (document.getElementById('question-page').style.display === "block") {
          if (e.key === "Escape") {
            returnToMain();
          } else if (e.key === "ArrowRight") {
            navigateQuestion(1);
          } else if (e.key === "ArrowLeft") {
            navigateQuestion(-1);
          }
        }
      });

      function showMainOptions() {
        document.getElementById('landing-page').style.display = 'none';
        document.querySelector('.main-options').style.display = 'flex';
      }

      function showShortQuestions() {
        document.querySelector('.main-options').style.display = 'none';
        shuffleQuizOptions();
        document.getElementById('quiz-section').style.display = 'block';
        updateCards(); // Make sure to update the cards when showing the quiz section
      }

      function showEmojiQuiz() {
        document.querySelector('.main-options').style.display = 'none';
        document.querySelector('.emoji-quiz').style.display = 'block';
        initializeEmojiQuiz();
      }

      function showAnalyticalScenario() {
        document.querySelector('.main-options').style.display = 'none';
        document.querySelector('.analytical-scenario').style.display = 'block';
      }

      function returnToMainOptions() {
        document.querySelector('.emoji-quiz').style.display = 'none';
        document.querySelector('.analytical-scenario').style.display = 'none';
        document.getElementById('quiz-section').style.display = 'none';
        document.getElementById('question-page').style.display = 'none';
        document.querySelector('.main-options').style.display = 'flex';
      }

      const emojiQuestions = [
        {
          emoji: "🧯🔥🚗",
          options: ["سرقة", "حريق عمد", "دهس"],
          answer: 1,
          explanation: "حريق عمد"
        },
        {
          emoji: "💻🔓🕵️‍♂️",
          options: ["احتيال بنكي", "دخول غير مشروع", "تجسس"],
          answer: 1,
          explanation: "دخول غير مشروع"
        },
        {
          emoji: "📷🙅‍♀️📲",
          options: ["قذف وتشهير", "تصوير غير مشروع", "تنمّر إلكتروني"],
          answer: 1,
          explanation: "تصوير غير مشروع (تعدّي على الخصوصية)"
        },
        {
          emoji: "👶👩‍🍼🏃‍♀️",
          options: ["خطف قاصر", "حرمان من الحضانة", "تبني غير قانوني"],
          answer: 0,
          explanation: "خطف قاصر"
        },
        {
          emoji: "📦🚚😡",
          options: ["غش تجاري", "خيانة أمانة", "سرقة موصوفة"],
          answer: 1,
          explanation: "خيانة أمانة (استلام وتسليم ثم إنكار)"
        },
        {
          emoji: "🧱🏡📏",
          options: ["تعدّي على ملكية", "مخالفة بناء", "تخريب ممتلكات"],
          answer: 0,
          explanation: "تعدّي على ملكية (بناء جدار على أرض الجار)"
        },
        {
          emoji: "📞😱💬",
          options: ["تهديد عبر الهاتف", "سب وشتم", "ابتزاز مالي"],
          answer: 0,
          explanation: "تهديد عبر الهاتف"
        },
        {
          emoji: "📱🛍️💳",
          options: ["احتيال إلكتروني", "تجارة إلكترونية مشبوهة", "تسويق كاذب"],
          answer: 0,
          explanation: "احتيال إلكتروني (استدراج بيانات الدفع)"
        }
      ];

      emojiQuestions.push(
        { emoji: "🚗💥🚶‍♂", options: ["حريق", "دهس", "سرقة سيارة"], answer: 1, explanation: "دهس" },
        { emoji: "🔪💔🩸", options: ["إيذاء نفسي", "جريمة قتل", "محاولة انتحار"], answer: 1, explanation: "جريمة قتل" },
        { emoji: "🔥🏠😱", options: ["إهمال منزلي", "حريق عمد", "كهرباء"], answer: 1, explanation: "حريق عمد" },
        { emoji: "🧒👊🩹", options: ["إهمال منزلي", "خطف أطفال", "عنف ضد الأطفال"], answer: 2, explanation: "عنف ضد الأطفال" },
        { emoji: "💼💸🏛", options: ["اختلاس", "رشوة", "غسيل أموال"], answer: 1, explanation: "رشوة" },
        { emoji: "🧓🏠🚪", options: ["إهمال أطفال", "إهمال كبار السن", "سرقة منزلية"], answer: 1, explanation: "إهمال كبار السن" },
        { emoji: "🔫🏦🏃‍♂🚓", options: ["سرقة بسيطة", "سطو على بنك", "اقتحام مبنى حكومي"], answer: 1, explanation: "سطو على بنك" },
        { emoji: "🧑‍💻👀🔐💻", options: ["برمجة تطبيق", "اختراق جهاز", "تحميل ملفات"], answer: 1, explanation: "اختراق جهاز" },
        { emoji: "📸👩🚫🌐", options: ["نشر إعلان", "نشر صور شخصية", "استخدام فلاتر"], answer: 1, explanation: "نشر صور شخصية" },
        { emoji: "🧍‍♀🛍💸❌", options: ["شراء قانوني", "بيع بضائع مسروقة", "خصم مزيف"], answer: 1, explanation: "بيع بضائع مسروقة" },
        { emoji: "👊🧍‍♂🤕🏥", options: ["خلاف شفهي", "الاعتداء الجسدي", "تهديد لفظي"], answer: 1, explanation: "الاعتداء الجسدي" },
        { emoji: "🚗👮‍♂🔎❌📃", options: ["إجراء روتيني", "تفتيش بدون إذن", "تنظيم المرور"], answer: 1, explanation: "تفتيش بدون إذن" },
        { emoji: "📝🧑‍🏫🧍‍♂🔄", options: ["غش جماعي", "انتحال شخصية بالامتحان", "تأجيل الامتحان"], answer: 1, explanation: "انتحال شخصية بالامتحان" },
        { emoji: "👩‍⚖💍📄✂", options: ["عقد زواج", "الطلاق", "تبني طفل"], answer: 1, explanation: "الطلاق" },
        { emoji: "📞📲👮‍♂❌", options: ["بلاغ حقيقي", "تبليغ كاذب", "شكوى غير واضحة"], answer: 1, explanation: "تبليغ كاذب" },
        { emoji: "🏠🔐🧍‍♂🚫", options: ["زيارة صديق", "تعدي على السكن", "فتح الباب بالخطأ"], answer: 1, explanation: "تعدي على السكن" },
        { emoji: "🧑‍⚖📑✍🧍‍♂👀", options: ["توقيع عادي", "توقيع دون قراءة", "موافقة شفوية"], answer: 1, explanation: "توقيع دون قراءة" },
        { emoji: "💻💳🧑‍💻🛒", options: ["تسوق طبيعي", "احتيال إلكتروني", "اشتراك مجاني"], answer: 1, explanation: "احتيال إلكتروني" },
        { emoji: "🚬🚫👦", options: ["بيع مرخص", "بيع تبغ لقاصر", "ترويج نيكوتين للبالغين"], answer: 1, explanation: "بيع تبغ لقاصر" },
        { emoji: "📞🤬🧍‍♀😢", options: ["مكالمة خدمة", "إساءة عبر الهاتف", "مزحة بين أصدقاء"], answer: 1, explanation: "إساءة عبر الهاتف" },
        { emoji: "👷‍♂🏗⚠❌", options: ["إجراءات اعتيادية", "إهمال السلامة", "اختبار معدات"], answer: 1, explanation: "إهمال السلامة" },
        { emoji: "👨‍👧‍👦❌💵📆", options: ["دفع جزئي", "تأجيل مؤقت", "عدم دفع النفقة"], answer: 2, explanation: "عدم دفع النفقة" },
        { emoji: "🚫📢👥🪧", options: ["تجمع عائلي", "مظاهرة بدون ترخيص", "مهرجان فني"], answer: 1, explanation: "مظاهرة بدون ترخيص" },
        { emoji: "🧾✒🔄❌", options: ["تصحيح إملائي", "تزوير مستند رسمي", "توقيع مكرر"], answer: 1, explanation: "تزوير مستند رسمي" },
        { emoji: "🧑‍⚖⚰📜🏠", options: ["عقد إيجار", "وصية أو تركة", "طلب رهن"], answer: 1, explanation: "وصية أو تركة" }
      );

      function initializeEmojiQuiz() {
        const quizContainer = document.getElementById('emoji-questions');
        quizContainer.innerHTML = '';

        emojiQuestions.forEach((q, index) => {
          // Shuffle options and update answer index
          const optionObjs = q.options.map((text, i) => ({ text, origIndex: i }));
          for (let i = optionObjs.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [optionObjs[i], optionObjs[j]] = [optionObjs[j], optionObjs[i]];
          }
          const newAnswerIndex = optionObjs.findIndex(opt => opt.origIndex === q.answer);

          const questionDiv = document.createElement('div');
          questionDiv.className = 'emoji-question';

          const emojiDiv = document.createElement('div');
          emojiDiv.className = 'emoji-display';
          emojiDiv.textContent = q.emoji;

          // Toggle button and options container
          const toggleBtn = document.createElement('button');
          toggleBtn.className = 'ent-show-btn';
          toggleBtn.textContent = 'إظهار الخيارات';
          toggleBtn.style.marginBottom = '10px';

          const optionsDiv = document.createElement('div');
          optionsDiv.className = 'emoji-options';
          optionsDiv.style.display = 'none';

          const resultDiv = document.createElement('div');
          resultDiv.className = 'emoji-result';

          optionObjs.forEach((optionObj, i) => {
            const button = document.createElement('button');
            button.className = 'emoji-option';
            button.textContent = optionObj.text;
            button.onclick = () => {
              const options = optionsDiv.querySelectorAll('button');
              options.forEach(opt => {
                opt.disabled = true;
                opt.classList.remove('correct', 'incorrect');
              });

              if (i === newAnswerIndex) {
                button.classList.add('correct');
                resultDiv.innerHTML = '✅ إجابة صحيحة!';
              } else {
                button.classList.add('incorrect');
                resultDiv.innerHTML = `❌ إجابة خاطئة<br>✅ الجواب الصحيح: ${String.fromCharCode(97 + newAnswerIndex)}. ${q.explanation}`;
              }
            };
            optionsDiv.appendChild(button);
          });

          toggleBtn.onclick = function() {
            if (optionsDiv.style.display === 'none') {
              optionsDiv.style.display = 'flex';
              toggleBtn.textContent = 'إخفاء الخيارات';
            } else {
              optionsDiv.style.display = 'none';
              toggleBtn.textContent = 'إظهار الخيارات';
              // Also clear result and re-enable options for retry
              resultDiv.innerHTML = '';
              optionsDiv.querySelectorAll('button').forEach(opt => {
                opt.disabled = false;
                opt.classList.remove('correct', 'incorrect');
              });
            }
          };

          questionDiv.appendChild(emojiDiv);
          questionDiv.appendChild(toggleBtn);
          questionDiv.appendChild(optionsDiv);
          questionDiv.appendChild(resultDiv);
          quizContainer.appendChild(questionDiv);
        });
      }

      function checkAnalyticalAnswer(selectedIndex) {
        const options = document.querySelectorAll('.analytical-scenario .option');
        options.forEach(option => option.onclick = null);
        
        if (selectedIndex === 2) { // Correct answer is C
          options[selectedIndex].classList.add('correct');
        } else {
          options[selectedIndex].classList.add('wrong');
          options[2].classList.add('correct');
        }
      }

      function showWheel() {
        document.querySelector('.main-options').style.display = 'none';
        document.querySelector('.wheel-container').style.display = 'flex';
      }

      function spinWheel() {
        const wheel = document.querySelector('.wheel');
        const spinButton = document.querySelector('.spin-button');
        const loading = document.querySelector('.loading');
        
        // Disable spin button
        spinButton.disabled = true;
        
        // Random number of full rotations (3-5) plus random angle
        const rotations = 3 + Math.floor(Math.random() * 3);
        const extraDegrees = Math.floor(Math.random() * 360);
        const totalDegrees = rotations * 360 + extraDegrees;
        
        // Apply rotation
        wheel.style.transform = `rotate(${totalDegrees}deg)`;
        
        // Calculate final position
        const finalPosition = totalDegrees % 360;
        let selectedOption;
        
        // Determine which option was selected
        if (finalPosition >= 0 && finalPosition < 120) {
          selectedOption = 0; // Quizzes
        } else if (finalPosition >= 120 && finalPosition < 240) {
          selectedOption = 1; // Predict Crime with Emojis
        } else {
          selectedOption = 2; // Solve the Crime
        }
        
        // Show loading after wheel stops
        setTimeout(() => {
          loading.style.display = 'block';
          
          // Navigate to selected option after 3 seconds
          setTimeout(() => {
            loading.style.display = 'none';
            document.querySelector('.wheel-container').style.display = 'none';
            
            switch(selectedOption) {
              case 0:
                showShortQuestions();
                break;
              case 1:
                showEmojiQuiz();
                break;
              case 2:
                showAnalyticalScenario();
                break;
            }
            
            // Reset wheel position and enable spin button
            setTimeout(() => {
              wheel.style.transition = 'none';
              wheel.style.transform = 'rotate(0deg)';
              setTimeout(() => {
                wheel.style.transition = 'transform 3s cubic-bezier(0.17, 0.67, 0.83, 0.67)';
                spinButton.disabled = false;
              }, 50);
            }, 1000);
          }, 3000);
        }, 3000);
      }

      // Add button to main options to show wheel
      document.querySelector('.main-options').innerHTML += `
        <button class="start-btn" onclick="showWheel()" style="margin-top: 20px;">Try Wheel of Fortune</button>
      `;

      // Add after the Try Wheel of Fortune button in .main-options
      document.querySelector('.main-options').innerHTML += `
        <button class="start-btn" onclick="showEntertainment()" style="margin-top: 20px; background: #f59e42; color: #fff;">ترفيه</button>
      `;

      // Add the ترفيه section HTML at the end of <body>
      document.body.insertAdjacentHTML('beforeend', `
        <div class="entertainment-section" style="display:none; padding:40px; max-width:600px; margin:40px auto; background:white; border-radius:15px; box-shadow:0 4px 16px rgba(0,0,0,0.08);">
          <button class="back-button" onclick="returnToMainOptions()">العودة للخيارات</button>
          <h2 style="text-align:center; color:#f59e42; margin-bottom:30px;">ترفيه</h2>
          <div class="ent-q-mc">
            <div class="ent-q-text">المتهم __________ حتى تثبت إدانته.</div>
            <button class="ent-show-btn" onclick="toggleEntOptions(this)">إظهار الخيارات</button>
            <div class="ent-options" style="display:none;">
              <button class="ent-option" onclick="checkEntAnswer(this, 0, 1)">أ. مذنب</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 1, 1)">ب. بريء</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 2, 1)">ج. موقوف</button>
            </div>
            <div class="ent-result"></div>
          </div>
          <div class="ent-q-mc">
            <div class="ent-q-text">يُمنع تصوير الأشخاص دون __________ منهم.</div>
            <button class="ent-show-btn" onclick="toggleEntOptions(this)">إظهار الخيارات</button>
            <div class="ent-options" style="display:none;">
              <button class="ent-option" onclick="checkEntAnswer(this, 0, 2)">أ. مراقبة</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 1, 2)">ب. أمر</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 2, 2)">ج. موافقة</button>
            </div>
            <div class="ent-result"></div>
          </div>
          <div class="ent-q-mc">
            <div class="ent-q-text">كل من يُقدم بلاغًا كاذبًا يُعاقب بـ __________.</div>
            <button class="ent-show-btn" onclick="toggleEntOptions(this)">إظهار الخيارات</button>
            <div class="ent-options" style="display:none;">
              <button class="ent-option" onclick="checkEntAnswer(this, 0, 1)">أ. تنبيه شفهي</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 1, 1)">ب. السجن والغرامة</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 2, 1)">ج. رسالة اعتذار</button>
            </div>
            <div class="ent-result"></div>
          </div>
          <div class="ent-q-mc">
            <div class="ent-q-text">العقود تُلزم المتعاقدين بمجرد __________.</div>
            <button class="ent-show-btn" onclick="toggleEntOptions(this)">إظهار الخيارات</button>
            <div class="ent-options" style="display:none;">
              <button class="ent-option" onclick="checkEntAnswer(this, 0, 1)">أ. الكلام</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 1, 1)">ب. التوقيع</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 2, 1)">ج. المصافحة</button>
            </div>
            <div class="ent-result"></div>
          </div>
          <div class="ent-q-mc">
            <div class="ent-q-text">لا يجوز تفتيش المنزل إلا بوجود __________.</div>
            <button class="ent-show-btn" onclick="toggleEntOptions(this)">إظهار الخيارات</button>
            <div class="ent-options" style="display:none;">
              <button class="ent-option" onclick="checkEntAnswer(this, 0, 1)">أ. بطاقة تعريف</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 1, 1)">ب. إذن قضائي</button>
              <button class="ent-option" onclick="checkEntAnswer(this, 2, 1)">ج. بلاغ شفهي</button>
            </div>
            <div class="ent-result"></div>
          </div>
        </div>
      `);

      // Add the toggleEntOptions function
      function toggleEntOptions(btn) {
        const optionsDiv = btn.nextElementSibling;
        if (optionsDiv.style.display === 'none') {
          optionsDiv.style.display = 'flex';
          btn.textContent = 'إخفاء الخيارات';
        } else {
          optionsDiv.style.display = 'none';
          btn.textContent = 'إظهار الخيارات';
          // Also clear result and re-enable options for retry
          const result = optionsDiv.parentElement.querySelector('.ent-result');
          result.innerHTML = '';
          optionsDiv.querySelectorAll('button').forEach(opt => {
            opt.disabled = false;
            opt.style.opacity = '';
            opt.style.background = '';
            opt.style.color = '';
            if (opt.innerHTML.includes('✅')) opt.innerHTML = opt.innerHTML.replace(' ✅','');
          });
        }
      }

      // Add the checkEntAnswer function
      function checkEntAnswer(btn, selected, correct) {
        const options = btn.parentElement.querySelectorAll('.ent-option');
        options.forEach((b, i) => {
          b.disabled = true;
          b.classList.remove('correct', 'wrong');
          if (i === correct) {
            b.classList.add('correct');
            if (!b.innerHTML.includes('✅')) b.innerHTML += ' ✅';
          } else if (i === selected) {
            b.classList.add('wrong');
          }
        });
        const result = btn.parentElement.parentElement.querySelector('.ent-result');
        if (selected === correct) {
          result.innerHTML = '<span style="color:#22c55e;font-weight:bold;">إجابة صحيحة!</span>';
        } else {
          result.innerHTML = '<span style="color:#ef4444;font-weight:bold;">إجابة خاطئة</span>';
        }
      }

      // Add showEntertainment function
      function showEntertainment() {
        document.querySelector('.main-options').style.display = 'none';
        document.querySelector('.entertainment-section').style.display = 'block';
      }

      // Update returnToMainOptions to hide entertainment section
      const oldReturnToMainOptions = returnToMainOptions;
      returnToMainOptions = function() {
        if (document.querySelector('.entertainment-section'))
          document.querySelector('.entertainment-section').style.display = 'none';
        oldReturnToMainOptions();
      }
    </script>
  </body>
</html>
